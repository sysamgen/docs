
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Pipelines overview &#8212; samgen 0.2.62-1-g79a1e00 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Running pipelines" href="../tech_docs/tech_docs.html" />
    <link rel="prev" title="System overview" href="../overview/overview.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pipelines-overview">
<h1>Pipelines overview<a class="headerlink" href="#pipelines-overview" title="Permalink to this headline">¶</a></h1>
<section id="somatic-exome">
<h2>somatic-exome<a class="headerlink" href="#somatic-exome" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/somatic-exome.png" src="../_images/somatic-exome.png" />
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h3>
<p>Somatic exome workflow based on <a class="reference external" href="https://github.com/sysamgen/analysis-workflows/blob/master/definitions/pipelines/somatic_exome.cwl">mgi-somatic-exome</a>.</p>
<section id="introduction">
<h4>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h4>
<p>Somatic_exome is designed to perform processing of mutant/wildtype H.sapiens
exome sequencing data. It features BQSR corrected alignments, 4 caller variant
detection, and vep style annotations. Structural variants are detected via
manta and cnvkit. In addition QC metrics are run, including
somalier concordance metrics.</p>
</section>
<section id="alignment-and-qc-step">
<h4>Alignment and QC step<a class="headerlink" href="#alignment-and-qc-step" title="Permalink to this headline">¶</a></h4>
<p>Pipeline starts with either fastq files or unaligned BAM files with necessary metadata describing analysis type, sample name, gender, distinction between tumor and normal.</p>
<p>This step is performed seperately for normal and tumor sample.</p>
<img alt="../_images/alignment_qc.png" src="../_images/alignment_qc.png" />
<p>Used tools:</p>
<ul class="simple">
<li><p><a class="reference external" href="10.1093/bioinformatics/btp324">bwa_mem 0.7.15</a> - for sequence alignment step using GRCh38 reference</p></li>
<li><p><a class="reference external" href="https://doi.org/10.1093/bioinformatics/btu314">samblaster 0.1.24</a> - for adding mate tags</p></li>
<li><p><a class="reference external" href="10.3390/biology1030895">flexbar 3.5</a> - for bar and adapter removal</p></li>
<li><p><a class="reference external" href="http://broadinstitute.github.io/picard/">picard:2.23.6</a> for alignment metrics</p></li>
<li><p><a class="reference external" href="10.1093/bioinformatics/btp352">samtools 1.11–h6270b1f_0</a> for BAM indexing and flagstat operation</p></li>
<li><p><a class="reference external" href="http://broadinstitute.github.io/picard/">picard 2.18.1</a> - for bedtointervals operation</p></li>
<li><p><a class="reference external" href="10.1101/gr.107524.110">gatk 4.1.8.1</a>  for Select Variants</p></li>
<li><p><a class="reference external" href="doi:10.1016/j.ajhg.2012.09.004">verifyBamId v1.1.3</a> - for checking whether the reads are contaminated as a mixture of two samples</p></li>
<li><p><a class="reference external" href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">fastqc</a> - for bam QC report</p></li>
<li><p><a class="reference external" href="10.1093/bioinformatics/btv566">qualimap</a> - for bam QC report</p></li>
<li><p><a class="reference external" href="10.1093/bioinformatics/btw354">multiqc</a> - QC</p></li>
</ul>
</section>
<section id="detect-variants-step">
<h4>Detect variants step<a class="headerlink" href="#detect-variants-step" title="Permalink to this headline">¶</a></h4>
<p>This step is performed for normal and tumor sample at once.
Once variants are standardized they are annotated with metadata collected and published by public databases.
In the afterburner step final postprocessing is performed including generating URLs to external databases and extracting genotype information from INFO field.</p>
<img alt="../_images/detect_variants.png" src="../_images/detect_variants.png" />
<p>Used tools:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.1038/nbt.2514">mutect 2</a> - for somatic variants detection</p></li>
<li><p><a class="reference external" href="10.1038/s41592-018-0051-x">strelka 2.9.9</a> - for somatic variants (SNPs and indels) detection</p></li>
<li><p><a class="reference external" href="10.1101/gr.129684.111">varscan 2.4.2</a> - for somatic variants detection</p></li>
<li><p><a class="reference external" href="10.1093/bioinformatics/btv710">manta 1.6.0</a> - for somatic structural variants detection</p></li>
<li><p><a class="reference external" href="https://doi.org/10.1371/journal.pcbi.1004873">cnvkit 0.9.8</a> - for copy number variants detection</p></li>
<li><p><a class="reference external" href="https://doi.org/10.1093/bioinformatics/btv112">vt 0.57721–hf74b74d_1</a> - for normalization and decomposition</p></li>
<li><p><a class="reference external" href="10.1093/gigascience/giab008">bcftools 1.12</a> - for vcf manipulations (merging, renaming samples)</p></li>
<li><p><a class="reference external" href="10.1093/bioinformatics/btp352">samtools 1.11</a>  - for indexing and sanitizing BAM files (removing mutect-specific format tags, removing non ACTGN bases)</p></li>
<li><p><a class="reference external" href="10.1101/gr.107524.110">gatk 4.1.8.1</a> - for DOCM variants detection and selecting, filtering variants</p></li>
<li><p><a class="reference external" href="10.1093/gigascience/giab008">bcftools</a> - QC for detected variants</p></li>
</ul>
</section>
</section>
<section id="input-parameters">
<h3>Input parameters<a class="headerlink" href="#input-parameters" title="Permalink to this headline">¶</a></h3>
<p><cite>sample_input.json</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;design&quot;</span><span class="p">:</span> <span class="s2">&quot;SSV6&quot;</span><span class="p">,</span>
  <span class="s2">&quot;flowcell_id&quot;</span><span class="p">:</span> <span class="s2">&quot;JHDAXCKJDLSK&quot;</span><span class="p">,</span>
  <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span>
  <span class="s2">&quot;is_test&quot;</span><span class="p">:</span> <span class="s2">&quot;_tests&quot;</span><span class="p">,</span>
  <span class="s2">&quot;normal_fastq1_path&quot;</span><span class="p">:</span> <span class="s2">&quot;cwl_inputs_folder/somatic-exome_tests/SRR7890845_chr17_test1_R1.fastq.gz&quot;</span><span class="p">,</span>
  <span class="s2">&quot;normal_fastq2_path&quot;</span><span class="p">:</span> <span class="s2">&quot;cwl_inputs_folder/somatic-exome_tests/SRR7890845_chr17_test1_R2.fastq.gz&quot;</span><span class="p">,</span>
  <span class="s2">&quot;normal_sample_id&quot;</span><span class="p">:</span> <span class="s2">&quot;normal_test_SID&quot;</span><span class="p">,</span>
  <span class="s2">&quot;patient_id&quot;</span><span class="p">:</span> <span class="s2">&quot;somatic_test_PID&quot;</span><span class="p">,</span>
  <span class="s2">&quot;phenotype&quot;</span><span class="p">:</span> <span class="s2">&quot;proband&quot;</span><span class="p">,</span>
  <span class="s2">&quot;template_path&quot;</span><span class="p">:</span> <span class="s2">&quot;dags/cwl/configurations/templates/somatic_exome_template.yaml&quot;</span><span class="p">,</span>
  <span class="s2">&quot;tumor_fastq1_path&quot;</span><span class="p">:</span> <span class="s2">&quot;cwl_inputs_folder/somatic-exome_tests/SRR7890844_chr17_test1_R1.fastq.gz&quot;</span><span class="p">,</span>
  <span class="s2">&quot;tumor_fastq2_path&quot;</span><span class="p">:</span> <span class="s2">&quot;cwl_inputs_folder/somatic-exome_tests/SRR7890844_chr17_test1_R2.fastq.gz&quot;</span><span class="p">,</span>
  <span class="s2">&quot;tumor_sample_id&quot;</span><span class="p">:</span> <span class="s2">&quot;tumor_test_SID&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="sample-rest-api-call">
<h3>Sample REST API call<a class="headerlink" href="#sample-rest-api-call" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl -v -g -X POST <span class="se">\</span>
  http://localhost:8080/api/v1/dags/somatic-exome/dagRuns <span class="se">\</span>
  -H <span class="s1">&#39;Cache-Control: no-cache&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;Content-Type: application/json&#39;</span> <span class="se">\</span>
  -d <span class="s2">&quot;{&#39;conf&#39;:\&#39;</span><span class="k">$(</span>cat sample_input.json <span class="p">|</span> sed <span class="s1">&#39;s/\&quot;/\\&quot;/g&#39;</span><span class="k">)</span><span class="s2">\&#39;}&quot;</span>
</pre></div>
</div>
</section>
<section id="sample-airflow-cli-invocation">
<h3>Sample Airflow cli invocation<a class="headerlink" href="#sample-airflow-cli-invocation" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>airflow dags trigger <span class="se">\</span>
-c <span class="s2">&quot;</span><span class="k">$(</span>cat sample_input.json<span class="k">)</span><span class="s2">&quot;</span> <span class="se">\</span>
-r dag_run-1 somatic-exome
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">samgen</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/overview.html">System overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Pipelines overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#somatic-exome">somatic-exome</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tech_docs/tech_docs.html">Running pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../catalogue/catalogue.html">Data catalogue</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../overview/overview.html" title="previous chapter">System overview</a></li>
      <li>Next: <a href="../tech_docs/tech_docs.html" title="next chapter">Running pipelines</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Agnieszka Szmurło, Tomasz Gambin, Mateusz Dawidziuk, Dominika Maziec, Marek Wiewiórka.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/dags/dags.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>